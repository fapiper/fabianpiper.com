base_path: "."

components:
  terraform:
    base_path: "components/terraform"
    apply_auto_approve: false
    deploy_run_init: true
    init_run_reconfigure: true
    auto_generate_backend_file: true
    backend_type: s3
    backend:
      s3:
        bucket: "k3s-tfstate"
        key: "terraform/{{.stack}}/{{.component}}/terraform.tfstate"
        region: "eu-frankfurt-1"
        endpoint: "https://{{.vars.oci_namespace}}.compat.objectstorage.eu-frankfurt-1.oraclecloud.com"
        skip_region_validation: true
        skip_credentials_validation: true
        skip_requesting_account_id: true
        skip_metadata_api_check: true
        use_path_style: true
        skip_s3_checksum: true

stacks:
  base_path: "stacks"
  included_paths:
    - "targets/**/*"
  name_pattern: "{stage}-{region}"

settings:
  list_merge_strategy: replace