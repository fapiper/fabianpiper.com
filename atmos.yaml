# Atmos CLI Configuration
# https://atmos.tools/cli/configuration/

base_path: "."

components:
  terraform:
    base_path: "components/terraform"
    apply_auto_approve: false
    deploy_run_init: true
    init_run_reconfigure: true
    auto_generate_backend_file: true
    # Global backend configuration for all components
    backend_type: s3
    backend:
      s3:
        bucket: "k3s-tfstate"
        key: "terraform/{{.component}}/terraform.tfstate"
        region: "us-ashburn-1"
        endpoint: "https://{{.env.OCI_NAMESPACE}}.compat.objectstorage.us-ashburn-1.oraclecloud.com"
        skip_region_validation: true
        skip_credentials_validation: true
        skip_requesting_account_id: true
        skip_metadata_api_check: true
        use_path_style: true
        skip_s3_checksum: true

stacks:
  base_path: "stacks"
  included_paths:
    - "deploy/**/*"
  excluded_paths:
    - "**/_defaults.yaml"
    - "**/catalog/**/*"
  name_pattern: "{tenant}-{environment}-{stage}"

logs:
  file: "/dev/stderr"
  level: Info

schemas:
  jsonschema:
    base_path: "stacks/schemas/jsonschema"
  opa:
    base_path: "stacks/schemas/opa"

templates:
  settings:
    enabled: true
    sprig:
      enabled: true
    gomplate:
      enabled: true

settings:
  list_merge_strategy: replace

terminal:
  color: true
  max_width: 120
  pager: false